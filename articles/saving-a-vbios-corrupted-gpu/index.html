<!DOCTYPE html>
<html lang="zh-CN">
<head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="color-scheme" content="dark light">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    <meta name="author" content="Rachel030219">
    
         
            <meta name="description" content="
a.k.a. 《一个学生不带脑子刷 vBIOS，这是他的显卡发生的变化》

…">
         
    
    <title>
        
            刷写 vBIOS 途中断电，我的自救复盘 | Rachel&#39;s Blog | Rachel030219
        
    </title>
    <link rel="icon" href="/favicon.svg"/>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@500;900&display=swap" rel="stylesheet">
    
<link rel="stylesheet" href="/css/style.css">

    
<link rel="stylesheet" href="/css/font-awesome.min.css">


<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Rachel's Blog | Rachel030219" type="application/atom+xml">
</head>
<body>
    <header class="header" id="header">
    <h1>
        <a class="title" href="/">
            Rachel
        </a>
    </h1>
    <h2>
        <a class="motto">
            Where Dreams Converge
        </a>
    </h2>
    <nav class="navbar">
        <ul class="menu">
            
            
                <li class="menu-item">
                    <a href="/" class="menu-item-link">
                        Home
                    </a>
                </li>
            
                
            
                <li class="menu-item">
                    <a href="/archives/" class="menu-item-link">
                        Archives
                    </a>
                </li>
            
                
            
                <li class="menu-item">
                    <a href="/atom.xml" class="menu-item-link">
                        RSS
                    </a>
                </li>
            
                
            
                <li class="menu-item">
                    <a target="_blank" rel="noopener" href="//rachelt.one" class="menu-item-link">
                        About
                    </a>
                </li>
            
                
            
                <li class="menu-item">
                    <a target="_blank" rel="noopener" href="//rachelt.one" class="menu-item-link">
                        Links
                    </a>
                </li>
            
                
            
                
                
                <li class="menu-item">
                    <a class="menu-item-link search">
                        Search→                   
                    </a>
                        <input placeholder="Search..." class="search-input" style="display:none;border:none!important;"></input>
                </li>
                
        </ul>
    </nav>
</header>
    <main class="main">
        <article class="post">
    <div class="title">
            <h1>
                刷写 vBIOS 途中断电，我的自救复盘 
            </h1>
    </div>
            <div class="meta">
                <a class="date"> 
                    <i class="fa fa-calendar" aria-hidden="true"></i>                    
                    2022-05-20
                </a>
                
                
                <a class="tag">
                    <i class="fa fa-tags" aria-hidden="true"></i>  
                </a>
                    <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/GPU/" rel="tag">GPU</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NVIDIA/" rel="tag">NVIDIA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vBIOS/" rel="tag">vBIOS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A1%AC%E4%BB%B6/" rel="tag">硬件</a></li></ul>
                
            </div>
            <div class="content">
                <blockquote>
<p>a.k.a. 《一个学生不带脑子刷 vBIOS，这是他的显卡发生的变化》</p>
</blockquote>
<h2 id="太长不看："><a href="#太长不看：" class="headerlink" title="太长不看："></a>太长不看：</h2><p>若 N 卡在刷 vBIOS 的过程中遭遇意外断电，随后主板自检反复重启，例如 DRAM - CPU - VGA 灯轮流亮，请寻找 <strong>能够亮机并且拥有 PCIe 槽的设备</strong> ，例如使用核显、亮机卡或者雷电接口显卡坞，开机过程中按住 Esc + C 进入 Windows 安全模式（或任意恢复系统，至少要阻止 NVIDIA 驱动加载），确定设备管理器中列出了损坏的显卡，再使用 nVFlash 刷回 <strong>备份的原 vBIOS</strong> 。</p>
<p>如果没有核显，则可能需要将坏卡接在主板的副 PCIe x16 槽位上。我将亮机卡接在副槽上时，主槽上接坏卡则仍然会反复重启；交换后才能正常启动。</p>
<p>如果亮机卡也是 N 卡，在刷写原 vBIOS 时需要手动指定设备序号：首先执行 <code>nvflash64.exe --list</code> ，此时应当会出现一个列表，其中格式如下：</p>
<span id="more"></span>

<pre><code>&lt;0&gt; Graphics Card:XXXX……
&lt;1&gt; 亮机卡型号:XXXX……
</code></pre>
<p>这其中没有型号的显卡就是我们要救的卡，它的 index 此时为 0，假设备份的文件是 <code>XXX.rom</code> ，执行 <code>nvflash64.exe --index=0 -6 XXX.rom</code> 即可。</p>
<p>如果没有备份原 vBIOS，或者设备管理器 &#x2F; <code>nvflash64.exe --list</code> 中没有看到显卡，则推荐寻求显卡制造商的帮助。</p>
<h2 id="吃了什么堑"><a href="#吃了什么堑" class="headerlink" title="吃了什么堑"></a>吃了什么堑</h2><p>接下来就是更加琐碎的部分：整件事的复盘。我会将 <strong>一些关键步骤</strong> 标记出来，并且附上相应的解释，希望至少能让我自己记住哪些应该多做，哪些应该尽量避免。</p>
<p>前几天换掉原来用的丐 ATX 机箱，投入了先马趣造的怀抱。把所有线材一通乱理、机箱往桌面一搁，折腾完毕后烤机看散热时，我发现一个此前因为机箱在桌下而感受不到的问题：这玩意儿太 ** 吵了！</p>
<p>一通排查后发现，显卡的风扇控制不太妙。超过某个温度阈值后它直接满速狂飙，温度降到室温或者都停不住它的转动，必须完全断电再开机才能恢复到智能转速。MSI Afterburner、HWiNFO64 和 TechPowerUp GPU-Z 都没能读出风扇转速（一直为 0），尝试用 MSI Afterburner 控制时则会直接飙到满速。</p>
<p>于是 <strong>第一次犯傻</strong> ：我怀疑是不是这显卡，影驰 2060 大将，根本没有带风扇智能启停功能。毕竟这是一张丐版卡，资料都搜不到多少，我也做好了它没有带高级功能的准备。根据 <a target="_blank" rel="noopener" href="https://www.chiphell.com/thread-1925230-1-1.html">Chiphell 上这篇帖子</a> 所述，似乎这一特性确实因 vBIOS 而异，所以我说干就干。</p>
<blockquote>
<p>事实上这并不是风扇智能启停的问题，而是风扇控制器的问题。负载低的情况下风扇转速是正常的，说明显卡至少还在自己控制转速，而为何转速高起来之后无法降下去，就是一个未解之谜了。</p>
</blockquote>
<p>到 <a target="_blank" rel="noopener" href="https://www.techpowerup.com/vgabios/">TechPowerUp VGA Bios Collection</a> 上找好顺眼的 vBIOS 后，我非常理智地 <strong>使用 GPU-Z 备份好原有的 vBIOS</strong> ，随后进入带网络的安全模式，刷写新的 vBIOS 并且下好最新的 NVIDIA 驱动，使用 <a target="_blank" rel="noopener" href="https://www.guru3d.com/files-details/display-driver-uninstaller-download.html"><ruby><rb>DDU</rb><rt>Display Driver Uninstaller</rt></ruby></a> 卸载系统上原有的驱动后重启，发现在安装驱动后显卡输出直接黑屏。</p>
<p>这当然不对劲嘛，还好我备份了一份 vBIOS，能直接刷回去。于是我如法炮制，重启到安全模式， <strong>第二次犯傻</strong> ：先使用 DDU 卸载并重启，卸到一半才意识到没有回刷 vBIOS 并慌忙开始刷。我 <strong>以为</strong> 驱动卸载会和此前一样耗时，而 vBIOS 只有 1MB 大，能够抢在重启前完成，没想到驱动没有完整安装，DDU 很快完成工作。当我意识到这一点时已经覆水难收，我看着 nVFlash 的进度条走到 20% 左右时突然黑屏，随后进入开头所述的重启循环。</p>
<p>眼看着对穷学生来说价格不菲的一张卡这样离我而去，我自然没有善罢甘休。我的 CPU 是不带核显的 5600X，显卡坞也已于数月前出掉，幸好此时主板上还有一根空闲的 PCIe 2.0x16 插槽（x4 速率、与第二根 M.2 冲突），并且出掉显卡坞前从家里拆来一张亮机卡 GT720 带来学校用于测试，它成了我唯一的希望。</p>
<p>我首先尝试将亮机卡插在这根空闲的副槽上，结果是无法启动，推测可能是 M.2 冲突，或者主槽的显卡没有拔掉。不管怎么样，要动第二根 M.2 就必须移除主槽的坏卡，所以我干脆直接连坏卡带硬盘一起去掉，然后见到了 1024x768 分辨率的熟悉锁屏界面。</p>
<p>此时「好耶」还太早，启动只是第一步，我还需要带着两块显卡一起启动。将坏卡插回主槽后，我再次尝试启动，结果又进入了重启循环。看起来之前插亮机卡不启动的问题很明确：主槽插着显卡的情况下，主板会尝试优先使用主槽显卡，若主槽显卡故障则不管副槽插没插卡都不会启动。</p>
<p>既然如此，只要是神志清楚的正常人都能想到：那我交换一下两张卡不就好？可惜， <strong>我的脑回路似乎有一点不正常</strong> ，我选择尝试 PCIe 热插拔。由于趣造是 ITX 大小的机箱，它下方没有留出额外空间，副槽插不下双槽高的显卡，要交换两张卡就必须拆出主板。「那也太麻烦了」，我心想，于是我先把亮机卡插入主槽启动进系统，试图 <strong>拔掉亮机卡并直接插入坏卡</strong> 。坏卡进槽的一瞬间，我看到了 PCIe 槽中打出的电弧。**我 *** 。</p>
<p>万幸，这张主板还算靠谱，这么折腾都没有坏，只是在打出电弧的一瞬间触发保护重启。不过我也不敢再来第二次，果断拆出主板，亮机卡插主槽坏卡插副槽，成功进入 Windows 安全模式。后续的操作很简单，确认设备管理器中认出显卡，确认 nVFlash 认出显卡，确认刷入 vBIOS 到坏卡，DDU 卸载驱动+重启，重新安装主板并理线，好耶！很有趣的是，这么一圈折腾下来，这破风扇控制器居然莫名其妙恢复了正常，真是咄咄怪事。</p>
<h2 id="长了什么智"><a href="#长了什么智" class="headerlink" title="长了什么智"></a>长了什么智</h2><p>要二次确认。不是说 <em>Yes, do as I say!</em> 这种很可能不会看的工具提示，即使 nVFlash 在刷写前提示我三次要不要继续，我依旧想都没想选 Yes；「二次确认」是指干什么要在脑子里想明白，确认风险概率极低（例如除非全寝断电否则不可能突然重启）再行动。</p>
<p>备份十分重要。没有此前备份的 vBIOS，我的显卡大概在刷到其他厂商的 vBIOS 后已经寄了。之前很多次数据丢失也是以为无害的操作，不知哪一天就会变成杀「机」利器。这也进一步让我产生配置一台 NAS，或者至少是阵列柜 &#x2F; 备份服务器的冲动。</p>
<p>要断电。热插拔显卡相较之下还算安全，至少最多干掉显卡不会干掉我，不过如果未来有朝一日我开着电修市电电路，可能送走的不只有一点钱，还要搭上我自己。</p>
<p>不要嫌麻烦。如果有看起来更麻烦但是怎么都更合理的选项，麻烦完全可以接受。因为「不合理」带来更多麻烦，那才是因小失大、自找麻烦。</p>
<p>没有了。希望我踩的坑能给读到这里的各位带来一点帮助。</p>

            </div>
          
           
            <div class="copyright">
                <div class="name">
                    <a>本文作者:</a>
                    <a>Rachel030219</a>
                </div>
                <div class="link">
                    <a>本文链接:</a>
                    <a class="permalink" href="https://blog.rachelt.one/articles/saving-a-vbios-corrupted-gpu/">https://blog.rachelt.one/articles/saving-a-vbios-corrupted-gpu/</a>
                </div>
                <div class="license">
                    <a>版权声明:</a>
                    <a>本博客所有文章除特别声明外，均采用许可协议 CC BY-NC-SA 3.0 。转载请注明出处！</a>
                </div>
                <div class="outdated">
                    <a><bold><br>本文写于 2022/05/20 （年月日），若所描述的内容与最新情况存在差异，请以最新情况为准。</bold></a>
                </div>
            </div>
            

          


</article>


<div class="more">

    <div class="prev">
   <a href="/articles/using-canokey-and-gpg-with-wsl-1/">← 优雅地在 WSL 1 上使用 CanoKey 进行 PGP 认证</a>
    </div>

<div class="space"></div>
<div class="space"></div>

    <div class="next">
        <a href="/articles/living-with-WP-for-7-days-in-2022/">2022 年，使用 Windows Phone 7 天 →</a>
    </div>

</div>
 
<div id="comments"></div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script>
    var gitalk = new Gitalk({
    id: "Fri May 20 2022 01:37:13 GMT+0800",
    admin: ["Rachel030219"],
    owner: "Rachel030219",
    repo: "Rachel-s-Blog",
    clientID:"fe3d26b97726d7cd74f2",
    clientSecret: "627109bc57f87d1aaa77b1269c5fecf1f7d78de9",
  })
  gitalk.render('comments')
</script>

<link rel="stylesheet" href="/css/gitalk.css">

        <div class="go-to-top-wrapper">
            <a onclick='window.scrollTo({top: 0, behavior: "smooth"});' class="go-to-top">
                <i class="fa fa-sort-asc fa-2x"></i>
            </a>
        </div>
    </main>
    <div class="search-items">
    </div>
    <footer class="footer">
    <div class="footer-copyright">©️2017-2021 <a href="//github.com/Vevlins/toki" class="link" target="_blank">Toki</a> by Vevlins<br />Proudly powered by <a href="https://hexo.io" class="link" target="_blank">Hexo</a>
</footer>

    
<script src="/js/tokinew.js"></script>
  

        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(r){r.imageLazyLoadSetting.processImages=t;var e=r.imageLazyLoadSetting.isSPA,n=r.imageLazyLoadSetting.preloadRatio||1,c=a();function a(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){e&&(c=a());for(var t,o=0;o<c.length;o++)0<=(t=(t=c[o]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(r.innerHeight*n||document.documentElement.clientHeight*n)&&function(){var t,e,n=c[o],a=n,i=function(){c=c.filter(function(t){return n!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(n)};a.hasAttribute("bg-lazy")?(a.removeAttribute("bg-lazy"),i&&i()):(t=new Image,e=a.getAttribute("data-original"),t.onload=function(){a.src=e,a.removeAttribute("data-original"),i&&i()},a.src!==e&&(t.src=e))}()}function i(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",i),r.addEventListener("resize",i),r.addEventListener("orientationchange",i)}(this);</script></body>
</html>
